(function(){var a=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];console=window.console=window.console||{};a.forEach(function(b){if(!console[b]){console[b]=function(){}}});console.dump=function(b){if(window.JSON&&window.JSON.stringify){console.log(JSON.stringify(b))}else{console.log(b)}}}());if(typeof(eshiol)==="undefined"){eshiol={}}if(typeof(eshiol.j2xml)==="undefined"){eshiol.j2xml={}}if(typeof(eshiol.j2xml.com_j2xml)==="undefined"){eshiol.j2xml.com_j2xml={}}eshiol.j2xml.com_j2xml.version="__DEPLOY_VERSION__";console.log("J2XML v"+eshiol.j2xml.com_j2xml.version);eshiol.j2xml.importerModal=function(){console.log("eshiol.j2xml.importerModal");jQuery("#j2xmlImportModal iframe").contents().find("#adminForm input[name^=jform], #adminForm select[name^=jform]").each(function(g){var f=jQuery(this);jQuery("<input>").attr({type:"hidden",id:f.attr("id"),name:f.attr("name"),value:f.val()}).appendTo("#adminForm")});window.top.setTimeout("window.parent.jQuery('#j2xmlImportModal').modal('hide')",700);xmlDoc=jQuery.parseXML(base64.decode(jQuery("#j2xml_data").val()));$xml=jQuery(xmlDoc);root=$xml.find(":root")[0];$root=jQuery(root);header='<?xml version="1.0" encoding="UTF-8" ?>\n<j2xml version="'+$root.attr("version")+'">\n';footer="\n</j2xml>";var a=[];$root.children("user").each(function(f){console.log("user: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("tag").each(function(f){console.log("tag: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("category").each(function(f){console.log("category: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("fieldgroup").each(function(f){console.log("fieldgroup: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("field").each(function(f){console.log("field: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("content").each(function(f){console.log("content: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children().each(function(f){if(["base","user","tag","category","content","fieldgroup","field"].indexOf(this.nodeName)==-1){console.log("other: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)}});eshiol.removeMessages();var d={tot:a.length,info:0,success:0,warning:0,error:0};if(typeof Joomla.getOptions!=="undefined"){var c=Joomla.getOptions("progressBarContainerClass","progress progress-striped active");var b=Joomla.getOptions("progressBarClass","bar bar");var e=Joomla.getOptions("progressBarErrorClass","bar bar-danger")}else{var c="progress progress-striped active";var b="bar bar";var e="bar bar-warning"}jQuery("#import-progress").remove();jQuery('<div id="import-progress" class="import-progress"><div class="'+c+'" style="font-size:1rem;height:1.5rem"><div id="import-progress-bar-info" class="'+b+'-info"></div><div id="import-progress-bar-success" class="'+b+'-success"></div><div id="import-progress-bar-warning" class="'+b+'-warning"></div><div id="import-progress-bar-error" class="'+e+'"></div></div></div>').insertAfter("#system-message-container");eshiol.j2xml.importer(a,d)};eshiol.j2xml.importer=function(b,d){console.log("eshiol.j2xml.importer");if(b.length>0){item=b.shift();var e=jQuery("#installer-token").val();var c="index.php?option=com_j2xml&task=import.ajax_upload";var f=new FormData();var a=new Blob([new TextEncoder().encode(item)],{type:"text/xml"});f.append("install_package",a,jQuery("#j2xml_filename").val());f.append("installtype","upload");f.append(e,1);jQuery("#j2xmlImportModal iframe").contents().find("#adminForm input:not(:radio)[name^=jform], #adminForm input:radio[name^=jform]:checked, #adminForm select[name^=jform]").each(function(h){var g=jQuery(this);f.append(g.attr("name"),g.val())});JoomlaInstaller.showLoading();jQuery.ajax({url:c,data:f,type:"post",processData:false,cache:false,contentType:false,error:function(g){console.log("error");console.log(g);JoomlaInstaller.hideLoading();eshiol.renderMessages({error:[g.responseText]});jQuery("#import-progress-bar-info").removeClass("progress-bar-striped").removeClass("progress-bar-animated");jQuery("#import-progress-bar-success").removeClass("progress-bar-striped").removeClass("progress-bar-animated");jQuery("#import-progress-bar-error").removeClass("progress-bar-striped").removeClass("progress-bar-animated");jQuery("#import-progress-bar-warning").removeClass("progress-bar-striped").removeClass("progress-bar-animated");setTimeout(function(){jQuery("#import-progress").remove()},10000)}}).done(function(h){console.log("done");if(h.messages){jQuery.each(h.messages,function(j,k){console.log(j+" "+k);if(j=="notice"){d.info++;jQuery("#import-progress-bar-info").css("width",(100*d.info/d.tot)+"%").text(d.info)}else{if(j=="message"){d.success++;jQuery("#import-progress-bar-success").css("width",(100*d.success/d.tot)+"%").text(d.success)}else{if(j=="error"){var i=Joomla.getOptions("J2XML");if(i&&i.HaltOnError){d.error=d.tot-d.info-d.success-d.warning;jQuery("#import-progress-bar-error").css("width",(100*d.error/d.tot)+"%").html(k);b=[]}else{d.error++;jQuery("#import-progress-bar-error").css("width",(100*d.error/d.tot)+"%").text(d.error)}}else{d.warning++;jQuery("#import-progress-bar-warning").css("width",(100*d.warning/d.tot)+"%").text(d.warning)}}}});eshiol.renderMessages(h.messages)}else{if(h.message){if(h.success){d.success++;var g=(100*d.success/d.tot);jQuery("#import-progress-bar-success").css("width",g+"%").text(d.success);console.log("#import-progress-bar-success.width: "+g);eshiol.renderMessages({message:[h.message]})}else{d.error++;jQuery("#import-progress-bar-error").css("width",(100*d.error/d.tot)+"%").text(d.error);eshiol.renderMessages({error:[h.message]})}}else{d.tot--;jQuery("#import-progress-bar-info").css("width",(100*d.info/d.tot)+"%");jQuery("#import-progress-bar-success").css("width",(100*d.success/d.tot)+"%");jQuery("#import-progress-bar-error").css("width",(100*d.error/d.tot)+"%");jQuery("#import-progress-bar-warning").css("width",(100*d.warning/d.tot)+"%")}}elements=document.getElementById("system-message-container").childNodes;if(typeof(elements)!="undefined"&&elements!=null){element=elements[elements.length-2];if(typeof(element)!="undefined"&&element!=null){element.scrollIntoView()}}jQuery.ajax({url:"index.php"}).done(function(i){if(b.length==0){JoomlaInstaller.hideLoading()}eshiol.j2xml.importer(b,d)})})}else{jQuery("#import-progress-bar-info").removeClass("progress-bar-striped").removeClass("progress-bar-animated");jQuery("#import-progress-bar-success").removeClass("progress-bar-striped").removeClass("progress-bar-animated");jQuery("#import-progress-bar-error").removeClass("progress-bar-striped").removeClass("progress-bar-animated");jQuery("#import-progress-bar-warning").removeClass("progress-bar-striped").removeClass("progress-bar-animated");setTimeout(function(){jQuery("#import-progress").remove()},10000)}};