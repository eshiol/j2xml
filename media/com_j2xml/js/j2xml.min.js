(function(){var e=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];console=window.console=window.console||{},e.forEach(function(e){console[e]||(console[e]=function(){})}),console.dump=function(e){window.JSON&&window.JSON.stringify?console.log(JSON.stringify(e)):console.log(e)}})(),"undefined"==typeof eshiol&&(eshiol={}),void 0===eshiol.j2xml&&(eshiol.j2xml={}),void 0===eshiol.j2xml.com_j2xml&&(eshiol.j2xml.com_j2xml={}),eshiol.j2xml.com_j2xml.version="__DEPLOY_VERSION__",console.log("J2XML v"+eshiol.j2xml.com_j2xml.version),eshiol.j2xml.importerModal=function(){console.log("eshiol.j2xml.importerModal"),jQuery("#j2xmlImportModal iframe").contents().find("#adminForm input[name^=jform], #adminForm select[name^=jform]").each(function(e){var r=jQuery(this);jQuery("<input>").attr({type:"hidden",id:r.attr("id"),name:r.attr("name"),value:r.val()}).appendTo("#adminForm")}),window.top.setTimeout("window.parent.jQuery('#j2xmlImportModal').modal('hide')",700);var e=[];try{xmlDoc=jQuery.parseXML(base64.decode(jQuery("#j2xml_data").val())),$xml=jQuery(xmlDoc),root=$xml.find(":root")[0],$root=jQuery(root),header='<?xml version="1.0" encoding="UTF-8" ?>\n<j2xml version="'+$root.attr("version")+'">\n',footer="\n</j2xml>",$root.children("user").each(function(r){console.log("user: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children("tag").each(function(r){console.log("tag: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children("category").each(function(r){console.log("category: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children("fieldgroup").each(function(r){console.log("fieldgroup: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children("field").each(function(r){console.log("field: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children("content").each(function(r){console.log("content: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children("menutype").each(function(r){console.log("menutype: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children("menu").each(function(r){console.log("menu: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children("module").each(function(r){console.log("module: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer)}),$root.children().each(function(r){-1==["base","user","tag","category","content","fieldgroup","field","menutype","menu","module"].indexOf(this.nodeName)&&(console.log("other: "+header+eshiol.XMLToString(this)+footer),e.push(header+eshiol.XMLToString(this)+footer))})}catch(r){console.log("file: "+base64.decode(jQuery("#j2xml_data").val())),e.push(base64.decode(jQuery("#j2xml_data").val()))}eshiol.removeMessages();var r={tot:e.length,info:0,success:0,warning:0,error:0};if(void 0!==Joomla.getOptions)var o=Joomla.getOptions("progressBarContainerClass","progress progress-striped active"),s=Joomla.getOptions("progressBarClass","bar bar"),t=Joomla.getOptions("progressBarErrorClass","bar bar-danger");else o="progress progress-striped active",s="bar bar",t="bar bar-warning";jQuery("#import-progress").remove(),jQuery('<div id="import-progress" class="import-progress"><div class="'+o+'" style="font-size:1rem;height:1.5rem"><div id="import-progress-bar-info" class="'+s+'-info"></div><div id="import-progress-bar-success" class="'+s+'-success"></div><div id="import-progress-bar-warning" class="'+s+'-warning"></div><div id="import-progress-bar-error" class="'+t+'"></div></div></div>').insertAfter("#system-message-container"),eshiol.j2xml.importer(e,r)},eshiol.j2xml.importer=function(e,r){if(console.log("eshiol.j2xml.importer"),e.length>0){item=e.shift();var o=jQuery("#installer-token").val(),s="index.php?option=com_j2xml&task=import.ajax_upload",t=new FormData,i=new Blob([(new TextEncoder).encode(item)],{type:"text/xml"});t.append("install_package",i,jQuery("#j2xml_filename").val()),t.append("installtype","upload"),t.append(o,1),jQuery("#j2xmlImportModal iframe").contents().find("#adminForm input:not(:radio)[name^=jform], #adminForm input:radio[name^=jform]:checked, #adminForm select[name^=jform]").each(function(e){var r=jQuery(this);t.append(r.attr("name"),r.val())}),JoomlaInstaller.showLoading(),jQuery.ajax({url:s,data:t,type:"post",processData:!1,cache:!1,contentType:!1,error:function(e){console.log("error"),console.log(e),JoomlaInstaller.hideLoading(),eshiol.renderMessages({error:[e.responseText]}),jQuery("#import-progress-bar-info").removeClass("progress-bar-striped").removeClass("progress-bar-animated"),jQuery("#import-progress-bar-success").removeClass("progress-bar-striped").removeClass("progress-bar-animated"),jQuery("#import-progress-bar-error").removeClass("progress-bar-striped").removeClass("progress-bar-animated"),jQuery("#import-progress-bar-warning").removeClass("progress-bar-striped").removeClass("progress-bar-animated"),setTimeout(function(){jQuery("#import-progress").remove()},1e4)}}).done(function(o){if(console.log("done"),o.messages)jQuery.each(o.messages,function(o,s){if(console.log(o+" "+s),"notice"==o)r.info++,jQuery("#import-progress-bar-info").css("width",100*r.info/r.tot+"%").text(r.info);else if("message"==o)r.success++,jQuery("#import-progress-bar-success").css("width",100*r.success/r.tot+"%").text(r.success);else if("error"==o){var t=Joomla.getOptions("J2XML");t&&t.HaltOnError?(r.error=r.tot-r.info-r.success-r.warning,jQuery("#import-progress-bar-error").css("width",100*r.error/r.tot+"%").html(s),e=[]):(r.error++,jQuery("#import-progress-bar-error").css("width",100*r.error/r.tot+"%").text(r.error))}else r.warning++,jQuery("#import-progress-bar-warning").css("width",100*r.warning/r.tot+"%").text(r.warning)}),eshiol.renderMessages(o.messages);else if(o.message)if(o.success){r.success++;var s=100*r.success/r.tot;jQuery("#import-progress-bar-success").css("width",s+"%").text(r.success),console.log("#import-progress-bar-success.width: "+s),eshiol.renderMessages({message:[o.message]})}else r.error++,jQuery("#import-progress-bar-error").css("width",100*r.error/r.tot+"%").text(r.error),eshiol.renderMessages({error:[o.message]});else r.tot--,jQuery("#import-progress-bar-info").css("width",100*r.info/r.tot+"%"),jQuery("#import-progress-bar-success").css("width",100*r.success/r.tot+"%"),jQuery("#import-progress-bar-error").css("width",100*r.error/r.tot+"%"),jQuery("#import-progress-bar-warning").css("width",100*r.warning/r.tot+"%");elements=document.getElementById("system-message-container").childNodes,"undefined"!=typeof elements&&null!=elements&&(element=elements[elements.length-2],"undefined"!=typeof element&&null!=element&&element.scrollIntoView()),jQuery.ajax({url:"index.php"}).done(function(o){0==e.length&&JoomlaInstaller.hideLoading(),eshiol.j2xml.importer(e,r)})})}else jQuery("#import-progress-bar-info").removeClass("progress-bar-striped").removeClass("progress-bar-animated"),jQuery("#import-progress-bar-success").removeClass("progress-bar-striped").removeClass("progress-bar-animated"),jQuery("#import-progress-bar-error").removeClass("progress-bar-striped").removeClass("progress-bar-animated"),jQuery("#import-progress-bar-warning").removeClass("progress-bar-striped").removeClass("progress-bar-animated"),setTimeout(function(){jQuery("#import-progress").remove()},1e4)};