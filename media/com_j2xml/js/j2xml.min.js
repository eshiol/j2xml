(function(){var a=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];console=window.console=window.console||{};a.forEach(function(b){if(!console[b]){console[b]=function(){}}});console.dump=function(b){if(window.JSON&&window.JSON.stringify){console.log(JSON.stringify(b))}else{console.log(b)}}}());if(typeof(eshiol)==="undefined"){eshiol={}}if(typeof(eshiol.j2xml)==="undefined"){eshiol.j2xml={}}if(typeof(eshiol.j2xml.com_j2xml)==="undefined"){eshiol.j2xml.com_j2xml={}}eshiol.j2xml.com_j2xml.version="__DEPLOY_VERSION__";console.log("J2XML v"+eshiol.j2xml.com_j2xml.version);eshiol.j2xml.importerModal=function(){console.log("eshiol.j2xml.importerModal");jQuery("#j2xmlImportModal iframe").contents().find("#adminForm input[name^=jform], #adminForm select[name^=jform]").each(function(f){var e=jQuery(this);jQuery("<input>").attr({type:"hidden",id:e.attr("id"),name:e.attr("name"),value:e.val()}).appendTo("#adminForm")});window.top.setTimeout("window.parent.jQuery('#j2xmlImportModal').modal('hide')",700);xmlDoc=jQuery.parseXML(atob(jQuery("#j2xml_data").val()));$xml=jQuery(xmlDoc);root=$xml.find(":root")[0];$root=jQuery(root);header='<?xml version="1.0" encoding="UTF-8" ?>\n<j2xml version="'+$root.attr("version")+'">\n';footer="\n</j2xml>";var a=[];$root.children("user").each(function(e){console.log("user: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("tag").each(function(e){console.log("tag: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("category").each(function(e){console.log("category: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("fieldgroup").each(function(e){console.log("fieldgroup: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("field").each(function(e){console.log("field: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children("content").each(function(e){console.log("content: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)});$root.children().each(function(e){if(["base","user","tag","category","content","fieldgroup","field"].indexOf(this.nodeName)==-1){console.log("other: "+header+eshiol.XMLToString(this)+footer);a.push(header+eshiol.XMLToString(this)+footer)}});eshiol.removeMessages();var d={tot:a.length,n:0};if(typeof Joomla.getOptions!=="undefined"){var c=Joomla.getOptions("progressBarContainerClass","progress progress-striped active");var b=Joomla.getOptions("progressBarClass","bar bar-success")}else{var c="progress progress-striped active";var b="bar bar-success"}jQuery("#system-message-container").prepend('<div id="import-progress" class="import-progress"><div class="'+c+'"><div id="import-progress-bar" class="'+b+'" aria-valuenow="0" aria-valuemin="0" aria-valuemax="'+d.tot+'"></div></div><p class="lead"><span id="import-progress-text" class="import-text">'+Joomla.JText._("COM_J2XML_IMPORTING").replace("%s","0%")+"</span></p></div>");eshiol.j2xml.importer(a,d)};eshiol.j2xml.importer=function(b,e){console.log("eshiol.j2xml.importer");if(b.length>0){var d=Math.floor(100*e.n/e.tot);jQuery("#import-progress-bar").css("width",d+"%").attr("aria-valuenow",e.n);jQuery("#import-progress-text").html(Joomla.JText._("COM_J2XML_IMPORTING").replace("%s",d+"%"));e.n++;item=b.shift();var f=jQuery("#installer-token").val();var c="index.php?option=com_j2xml&task=import.ajax_upload";var g=new FormData();var a=new Blob([new TextEncoder().encode(item)],{type:"text/xml"});g.append("install_package",a,jQuery("#j2xml_filename").val());g.append("installtype","upload");g.append(f,1);jQuery("#j2xmlImportModal iframe").contents().find("#adminForm input:not(:radio)[name^=jform], #adminForm input:radio[name^=jform]:checked, #adminForm select[name^=jform]").each(function(i){var h=jQuery(this);g.append(h.attr("name"),h.val())});document.getElementById("system-message-container").scrollIntoView();JoomlaInstaller.showLoading();console.log(c);console.log(g);jQuery.ajax({url:c,data:g,type:"post",processData:false,cache:false,contentType:false,error:function(h){console.log("error");console.log(h);JoomlaInstaller.hideLoading();eshiol.renderMessages({error:[h.responseText]});jQuery("#import-progress").remove()}}).done(function(h){console.log("done");if(h.messages){eshiol.renderMessages(h.messages)}else{if(h.message){if(h.success){eshiol.renderMessages({message:[h.message]})}else{eshiol.renderMessages({error:[h.message]})}}}jQuery.ajax({url:"index.php"}).done(function(i){if(b.length==0){JoomlaInstaller.hideLoading()}eshiol.j2xml.importer(b,e)})})}else{jQuery("#import-progress").remove()}};