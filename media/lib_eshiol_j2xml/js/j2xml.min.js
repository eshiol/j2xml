/**
 * @package     Joomla.Libraries
 * @subpackage  eshiol.J2XML
 *
 * @version     __DEPLOY_VERSION__
 * @since		16.11.288
 *
 * @author      Helios Ciancio <info (at) eshiol (dot) it>
 * @link        https://www.eshiol.it
 * @copyright   Copyright (C) 2010 - 2023 Helios Ciancio. All Rights Reserved
 * @license     http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL v3
 * J2XML is free software. This version may have been modified pursuant
 * to the GNU General Public License, and as distributed it includes or
 * is derivative of works licensed under the GNU General Public License
 * or other free or open source software licenses.
 */
if(console.log("jQuery version: "+jQuery.fn.jquery),function(){var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];console=window.console=window.console||{},methods.forEach((function(method){console[method]||(console[method]=function(){})})),console.dump=function(object){window.JSON&&window.JSON.stringify?console.log(JSON.stringify(object)):console.log(object)}}(),Joomla.JText.strings.SUCCESS="Message",void 0===eshiol)var eshiol={};void 0===eshiol.j2xml&&(eshiol.j2xml={}),void 0===eshiol.j2xml.convert&&(eshiol.j2xml.convert=[]),void 0===eshiol.j2xml.validate&&(eshiol.j2xml.validate=[]),eshiol.j2xml.validate.push((function(data){console.log("eshiol.j2xml.library.validate");try{return xmlDoc=jQuery.parseXML(data),xml=jQuery(xmlDoc),root=xml.find(":root")[0],console.log("eshiol.j2xml.library.validated: "+("j2xml"==root.nodeName&&versionCompare(jQuery(root).attr("version"),"15.9.0")>=0)),"j2xml"==root.nodeName&&versionCompare(jQuery(root).attr("version"),"15.9.0")>=0}catch(e){return!1}})),eshiol.j2xml.version="__DEPLOY_VERSION__",console.log("J2XML Library v"+eshiol.j2xml.version),void 0===eshiol.removeMessages&&(eshiol.removeMessages=function(messageContainer){void 0===messageContainer&&(messageContainer=jQuery("#system-message-container")),messageContainer.empty(),messageContainer.css("display","none"),messageContainer.outerHeight(!0),messageContainer.css("display","")})
/**
 * @copyright  (C) 2020 Open Source Matters, Inc. <https://www.joomla.org>
 * @license    GNU General Public License version 2 or later; see LICENSE.txt
 */;const getMessageContainer=container=>{let messageContainer;return container instanceof HTMLElement?container:(messageContainer=void 0===container||container&&"#system-message-container"===container?document.getElementById("system-message-container"):document.querySelector(container),messageContainer)};if(void 0===eshiol.renderMessages&&(eshiol.renderMessages=function(messages,selector){var j2xmlOptions=Joomla.getOptions("J2XML"),JoomlaVersion,messageContainer;"4"==(j2xmlOptions&&j2xmlOptions.Joomla?j2xmlOptions.Joomla:"3")?(messageContainer=void 0===selector?getMessageContainer(selector):selector,[].slice.call(Object.keys(messages)).forEach(type=>{let alertClass=type;const typeMessages=messages[type],messagesBox=document.createElement("joomla-alert");["success","info","danger","warning"].indexOf(type)<0&&(alertClass="notice"===type?"info":type,alertClass="message"===type?"success":alertClass,alertClass="error"===type?"danger":alertClass,alertClass="warning"===type?"warning":alertClass),messagesBox.setAttribute("type",alertClass),messagesBox.setAttribute("close-text",Joomla.Text._("JCLOSE")),messagesBox.setAttribute("dismiss",!0);const title=Joomla.Text._(type);if(void 0!==title){const titleWrapper=document.createElement("div");titleWrapper.className="alert-heading",titleWrapper.innerHTML=Joomla.sanitizeHtml(`<span class="${type}"></span><span class="visually-hidden">${Joomla.Text._(type)?Joomla.Text._(type):type}</span>`),messagesBox.appendChild(titleWrapper)}const messageWrapper=document.createElement("div");messageWrapper.className="alert-wrapper","string"==typeof messages[type]?messageWrapper.innerHTML+=Joomla.sanitizeHtml(`<div class="alert-message">${messages[type]}</div>`):typeMessages.forEach(typeMessage=>{messageWrapper.innerHTML+=Joomla.sanitizeHtml(`<div class="alert-message">${typeMessage}</div>`)}),messagesBox.appendChild(messageWrapper),messageContainer.appendChild(messagesBox)})):(messageContainer=void 0===selector?jQuery("#system-message-container"):jQuery(selector),jQuery.each(messages,(function(type,message){"message"==type&&(type="success");var div=messageContainer.find("div.alert.alert-"+type);div[0]?div=div[0]:(jQuery("<button/>",{class:"close","data-dismiss":"alert",type:"button",html:"&times;"}).appendTo(messageContainer),div=jQuery("<div/>",{class:"alert alert-"+type}).appendTo(messageContainer),jQuery("<h4/>",{class:"alert-heading",html:Joomla.JText._(type,type.charAt(0).toUpperCase()+type.slice(1))}).appendTo(div)),jQuery.each(message,(function(index,item){jQuery("<p/>",{html:item}).appendTo(div)}))})))}),eshiol.j2xml.codes=["message","notice","message","notice","notice","notice","message","notice","message","notice","message","notice","message","notice","notice","error","notice","error","error","error","message","notice","message","notice","message","notice","message","notice","error","warning","notice","message","notice","message","notice","message","notice","notice","message","notice","message","notice","message","notice","message","notice","notice"],eshiol.j2xml.sendItem=function(options,params){if(options.cids.length){var cid=options.cids.shift();isNaN(options.n)&&(options.n=0);var progress=Math.floor(100*options.n/options.tot);window.parent.jQuery("#send-progress-bar").css("width",progress+"%").attr("aria-valuenow",options.n),window.parent.jQuery("#send-progress-text").html(Joomla.JText._("LIB_J2XML_SENDING").replace("%s",progress+"%")),options.n++,console.log("exporting data from "+options.export_url),console.log(params),Joomla.request({url:options.export_url+"&cid[]="+cid,data:Object.keys(params).map((function(key){return encodeURIComponent(key)+"="+encodeURIComponent(params[key])})).join("&"),onSuccess:function onSuccess(resp){console.log("export.onSuccess"),console.log("sending data via xmlrpc to "+options.remote_url);var r=JSON.parse(resp);p=params,delete p.compression,console.log(p),jQuery.xmlrpc({url:options.remote_url,methodName:"j2xml.importAjax",params:[r.data,JSON.stringify(p)],xhrFields:{withCredentials:!0},success:function(response,status,jqXHR){console.log("send.onSuccess"),window.parent.jQuery("input:checkbox[name='checkall-toggle']").prop("checked",!1),window.parent.jQuery("input:checkbox[name='cid[]'][value='"+cid+"']").prop("checked",!1),jQuery.each(response,(function(index,messages){messages.forEach((function(item){console.log(item),msg=new Object,item.code in eshiol.j2xml.codes?t=eshiol.j2xml.codes[item.code]:t="notice",msg[t]=[item.message],eshiol.renderMessages(msg,window.parent.document.getElementById("system-message-container"))}))})),eshiol.j2xml.sendItem(options,params)},error:function(jqXHR,status,error){msg=new Object,"object"==typeof error?(error.code in eshiol.j2xml.codes?t=eshiol.j2xml.codes[error.code]:t="error",msg[t]=[error.message]):msg.error=error?[error]:[Joomla.Text._("LIB_J2XML_ERROR_UNKNOWN").replace("%s",window.location.origin)],eshiol.renderMessages(msg,window.parent.document.getElementById("system-message-container")),eshiol.j2xml.sendItem(options,params)}})},onError:function onError(xhr){xhr.status>0&&Joomla.renderMessages(Joomla.ajaxErrorsMessages(xhr)),eshiol.j2xml.sendItem(options,params)}})}else window.parent.jQuery("#send-progress").remove()},eshiol.j2xml.send=function(options){if(console.log("eshiol.j2xml.send"),options.cids=[],options.tot=0,options.alert=0,options.error=0,options.success=0,options.warning=0,void 0!==Joomla.getOptions)var progressBarContainerClass=Joomla.getOptions("progressBarContainerClass","progress progress-striped active"),progressBarClass=Joomla.getOptions("progressBarClass","bar bar-success");else var progressBarContainerClass="progress progress-striped active",progressBarClass="bar bar-success";window.parent.jQuery("#system-message-container").prepend('<div id="send-progress" class="send-progress"><div class="'+progressBarContainerClass+'"><div id="send-progress-bar" class="'+progressBarClass+'" aria-valuenow="0" aria-valuemin="0" aria-valuemax="'+options.tot+'"></div></div><p class="lead"><span id="send-progress-text" class="sending-text">'+Joomla.JText._("LIB_J2XML_SENDING").replace("%s","0%")+"</span></p></div>");var params={};jQuery("#adminForm input:not(:radio)[name^=jform], #adminForm input:radio[name^=jform]:checked, #adminForm select[name^=jform]").each((function(index){var input=jQuery(this),name=input.attr("name").match(/jform\[(.*)\]/)[1];"send_"==name.substr(0,5)&&(name=name.substr(5)),-1==["cid","remote_url"].indexOf(name)&&(params[name]=input.val())})),navigator.__defineGetter__("userAgent",(function(){return eshiol.j2xml.version})),window.parent.jQuery("input:checkbox[name='cid[]']:checked").each((function(){options.cids.push(jQuery(this).val()),options.tot++})),eshiol.j2xml.sendItem(options,params)},eshiol.XMLToString=function(xmlDom){return x="undefined"!=typeof XMLSerializer?(new window.XMLSerializer).serializeToString(xmlDom):xmlDom.xml,x},void 0===strstr)function strstr(haystack,needle,bool){var pos=0;return-1!=(pos=(haystack+="").indexOf(needle))&&(bool?haystack.substr(0,pos):haystack.slice(pos))}eshiol.download=function(filename,text){var element=document.createElement("a");element.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(text)),element.setAttribute("download",filename),element.style.display="none",document.body.appendChild(element),element.click(),document.body.removeChild(element)};